<!-- Place file at: src/app/ui/header.component.html
     REPLACE existing file. Uses Font Awesome icons (free). -->

<!-- Guest -->
<header *ngIf="designVariant === 'guest'" class="meesho-header design-guest" [class.scrolled]="isScrolled">
  <div class="mh-row">
    
    <a routerLink="/" class="mh-brand" aria-label="home"><img src="/assets/logo.png" alt="logo" /></a>

    <form class="mh-search" (ngSubmit)="onSearch()" role="search">
      <input type="search" name="q" [(ngModel)]="query" placeholder="Search products, brands and more"
        class="mh-search-input" (input)="onInput($event)" autocomplete="off" />
      <button class="mh-search-go" type="submit">Go</button>
    </form>

    <div class="mh-controls">
      <a routerLink="/login" class="mh-icon-btn" aria-label="login">
        <i class="fas fa-sign-in-alt" aria-hidden="true"></i>
      </a>
    </div>
  </div>
</header>

<!-- Admin -->
<header *ngIf="designVariant === 'admin'" class="meesho-header design-admin" [class.scrolled]="isScrolled">
  <div class="mh-row">

    <a routerLink="/admin" class="mh-brand" aria-label="admin"><img src="/assets/logo.png" alt="admin" /></a>

    <form class="mh-search" (ngSubmit)="onSearch()" role="search">
      <input type="search" name="q" [(ngModel)]="query" placeholder="Search orders, users, SKUs" class="mh-search-input"
        (input)="onInput($event)" autocomplete="off" />
      <button class="mh-search-go" type="submit">Go</button>
    </form>

    <div class="mh-controls">
  
      <!-- USER MENU (admin) -->
      <div class="mh-user" [class.open]="isUserMenuOpen">
        <button class="mh-user-btn" type="button" aria-haspopup="true" [attr.aria-expanded]="isUserMenuOpen"
          (click)="toggleUserMenu($event)" (touchend)="$event.preventDefault(); toggleUserMenu($event)">
          <i class="fas fa-user-shield" aria-hidden="true"></i>
          <span class="mh-username">{{ currentUser?.name || 'Admin' }}</span>
        </button>

        <!-- keep in DOM but hide/show with .open and aria-hidden -->
        <ul class="mh-user-menu" [attr.aria-hidden]="!isUserMenuOpen">
          <li><a routerLink="/admin" (click)="closeUserMenu()">Dashboard</a></li>
          <li><button class="link-like" (click)="logout(); closeUserMenu()">Logout</button></li>
        </ul>
      </div>
    </div>
  </div>
</header>

<!-- Customer / Retailer -->
<header *ngIf="designVariant === 'customer'" class="meesho-header design-customer" [class.scrolled]="isScrolled">
  <div class="mh-row">


    <a routerLink="/" class="mh-brand" aria-label="home"><img src="/assets/logo.png" alt="logo" /></a>

    <form class="mh-search" (ngSubmit)="onSearch()" role="search">
      <button type="button" class="mh-search-left" (click)="$event.preventDefault()">
        <i class="fas fa-search" aria-hidden="true"></i>
      </button>
      <input type="search" name="q" [(ngModel)]="query" placeholder="Search for products, brands and more"
        class="mh-search-input" (input)="onInput($event)" autocomplete="off" />
      <button class="mh-search-go" type="submit">Go</button>
    </form>

    <div class="mh-controls">
      <a routerLink="/cart" class="mh-icon-btn" aria-label="cart">
        <i class="fas fa-shopping-cart" aria-hidden="true"></i>
        <span class="mh-badge" *ngIf="(cartCount$ | async) as c">{{ c }}</span>
      </a>

      <!-- USER MENU (customer/retailer) -->
      <div class="mh-user" [class.open]="isUserMenuOpen">
        <button class="mh-user-btn" type="button" aria-haspopup="true" [attr.aria-expanded]="isUserMenuOpen"
          (click)="toggleUserMenu($event)" (touchend)="$event.preventDefault(); toggleUserMenu($event)">
          <i class="fas fa-user" aria-hidden="true"></i>
          <span class="mh-username">{{ currentUser?.name || 'Account' }}</span>
        </button>

        <ul class="mh-user-menu" [attr.aria-hidden]="!isUserMenuOpen">
          <li *ngIf="role === 'admin'"><a routerLink="/admin" (click)="closeUserMenu()">Admin Panel</a></li>
          <li *ngIf="role === 'retailer'"><a routerLink="/retailer" (click)="closeUserMenu()">Retailer</a></li>
          <li *ngIf="role === 'customer'"><a routerLink="/orders" (click)="closeUserMenu()">My Orders</a></li>
          <li><button class="link-like" (click)="logout(); closeUserMenu()">Logout</button></li>
        </ul>
      </div>

      <a *ngIf="!role" routerLink="/login" class="mh-login">Login</a>
    </div>
  </div>

  <div class="mh-cats-panel" *ngIf="mobileCatsVisible">
    <div class="mh-cats-head d-flex">
      <strong>Categories</strong>
      <button class="mh-close" (click)="toggleMobileCategories()">Close</button>
    </div>
    <ul class="mh-cats-list">
      <li *ngFor="let c of categories"><a href="#">{{ c }}</a></li>
    </ul>
  </div>
</header>