<!-- src/app/admin/order-management.component.html -->
<div class="container-fluid mt-4">
  <div class="row">
    <div class="col-12">
      <h2>Order Management</h2>
      
      <!-- Statistics -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="card text-white bg-primary">
            <div class="card-body">
              <h4>{{stats.total}}</h4>
              <p class="mb-0">Total Orders</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-white bg-warning">
            <div class="card-body">
              <h4>{{stats.pending}}</h4>
              <p class="mb-0">Pending</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-white bg-success">
            <div class="card-body">
              <h4>{{stats.delivered}}</h4>
              <p class="mb-0">Delivered</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-white bg-info">
            <div class="card-body">
              <h4>₹{{stats.revenue}}</h4>
              <p class="mb-0">Revenue</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Filters -->
      <div class="card mb-4">
        <div class="card-body">
          <div class="row g-3">
            <div class="col-md-3">
              <label class="form-label">Status</label>
              <select class="form-select" [(ngModel)]="statusFilter" (change)="loadOrders()">
                <option value="">All Status</option>
                <option value="PENDING">Pending</option>
                <option value="CONFIRMED">Confirmed</option>
                <option value="PROCESSING">Processing</option>
                <option value="SHIPPED">Shipped</option>
                <option value="DELIVERED">Delivered</option>
                <option value="CANCELLED">Cancelled</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">Start Date</label>
              <input type="date" class="form-control" [(ngModel)]="dateRange.start" (change)="loadOrders()">
            </div>
            <div class="col-md-3">
              <label class="form-label">End Date</label>
              <input type="date" class="form-control" [(ngModel)]="dateRange.end" (change)="loadOrders()">
            </div>
            <div class="col-md-3 d-flex align-items-end">
              <button class="btn btn-outline-secondary w-100" (click)="loadOrders()">
                Refresh
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Orders Table -->
      <div class="card">
        <div class="card-body">
          <div *ngIf="loading" class="text-center py-3">
            <div class="spinner-border" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>

          <div *ngIf="!loading && orders.length === 0" class="text-center py-5">
            <h5>No orders found</h5>
          </div>

          <div *ngIf="!loading && orders.length > 0" class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Order #</th>
                  <th>Customer</th>
                  <th>Date</th>
                  <th>Amount</th>
                  <th>Status</th>
                  <th>Payment</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let order of orders">
                  <td>
                    <strong>{{order.orderNumber}}</strong>
                    <br>
                    <small class="text-muted">ID: {{order.id}}</small>
                  </td>
                  <td>
                    <div>{{order.userName}}</div>
                    <small class="text-muted">{{order.userEmail}}</small>
                  </td>
                  <td>{{order.createdAt | date:'short'}}</td>
                  <td>₹{{order.totalAmount}}</td>
                  <td>
                    <select class="form-select form-select-sm" 
                            [value]="order.status"
                            (change)="updateOrderStatus(order.id, $event.target.value)">
                      <option value="PENDING">Pending</option>
                      <option value="CONFIRMED">Confirmed</option>
                      <option value="PROCESSING">Processing</option>
                      <option value="SHIPPED">Shipped</option>
                      <option value="DELIVERED">Delivered</option>
                      <option value="CANCELLED">Cancelled</option>
                    </select>
                  </td>
                  <td>
                    <span class="badge" 
                          [class.bg-success]="order.paymentStatus === 'PAID'"
                          [class.bg-warning]="order.paymentStatus === 'PENDING'"
                          [class.bg-danger]="order.paymentStatus === 'FAILED'">
                      {{order.paymentStatus}}
                    </span>
                  </td>
                  <td>
                    <button class="btn btn-sm btn-outline-primary" 
                            [routerLink]="['/admin/orders', order.id]">
                      View
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>