/* FILE: src/app/admin/product-upload.component.scss
   REPLACE or MERGE with your existing file at src/app/admin/product-upload.component.scss
   -- ADDED styles for .variant-input and mobile tuning (search for "VARIANT INPUT" comments)
*/

/* ---------------------- VARIABLES ---------------------- */
$bg: #f7f8fa;
$card-bg: #ffffff;
$text: #111827;
$muted: #6b7280;
$border: #e6e9ee;
$primary: #0b74ff;
$secondary: #6c757d;
$radius: 12px;
$shadow-sm: 0 6px 18px rgba(10,15,25,0.04);
$shadow-lg: 0 12px 40px rgba(10,15,25,0.06);
$max-width: 1100px;

/* ---------------------- LAYOUT ---------------------- */
:host { display: block; background: $bg; min-height: 100%; }

.admin-container {
  max-width: $max-width;
  margin: 14px auto;
  padding: 14px;
  box-sizing: border-box;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color: $text;
}

/* Card */
.card {
  background: $card-bg;
  border-radius: $radius;
  padding: 14px;
  margin-bottom: 14px;
  box-shadow: $shadow-sm;
  border: 1px solid $border;

  h3 {
    margin: 0 0 10px 0;
    font-size: 1rem;
    font-weight: 600;
    color: $text;
    padding-bottom: 8px;
  }
}

/* small helper */
.row-actions { display:flex; gap:8px; align-items:center; }

/* ---------------------- FORM GRID (mobile-first) ---------------------- */
.form-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;

  label {
    display: block;
    font-weight: 600;
    font-size: 0.95rem;
    color: $text;

    input, textarea, select, .ng-select-container {
      display: block;
      width: 100%;
      margin-top: 6px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid $border;
      background: #fff;
      font-size: 0.95rem;
      color: $text;
      box-sizing: border-box;
      transition: box-shadow .12s ease, border-color .12s ease;
    }

    textarea { min-height: 80px; resize: vertical; }

    input:focus, textarea:focus, select:focus, .ng-select-container:focus-within {
      outline: none;
      border-color: $primary;
      box-shadow: 0 8px 30px rgba(11,116,255,0.08);
    }
  }

  .row-actions {
    margin-top: 4px;
    justify-content: flex-start;

    button { min-height: 40px; }
  }
}

/* ---------------------- BUTTONS ---------------------- */
.btn, button {
  cursor: pointer;
  border: none;
  border-radius: 10px;
  padding: 10px 14px;
  font-weight: 700;
  font-size: 0.95rem;
  transition: transform .08s ease, box-shadow .12s ease, opacity .12s ease;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  line-height: 1;
}

.btn-primary {
  background: linear-gradient(180deg, lighten($primary, 6%), $primary);
  color: #fff;
  box-shadow: 0 8px 20px rgba(11,116,255,0.12);
}
.btn-primary:hover { transform: translateY(-2px); }

.btn-secondary {
  background: $secondary;
  color: #fff;
  box-shadow: 0 6px 16px rgba(108,117,125,0.08);
}

.btn-outline {
  background: transparent;
  border: 1px solid $border;
  color: $text;
}

.btn-warning {
  background: linear-gradient(180deg, #ffe4a3, #ffc107);
  color: #222;
}

/* small close button used on thumbs */
.btn-close {
  background: #fff;
  border-radius: 50%;
  width: 28px;
  height: 28px;
  display: inline-grid;
  place-items: center;
  border: 1px solid rgba(0,0,0,0.06);
  font-weight: 700;
  cursor: pointer;
}

/* focus visible */
button:focus-visible, .btn:focus-visible {
  outline: 3px solid rgba(11,116,255,0.12);
  outline-offset: 3px;
}

/* ---------------------- FILE INPUT & THUMBS ---------------------- */
/* make the visible label look like a button; hide default input */
#addFiles {
  display: none; /* actual file input hidden */
}

/* clickable label style */
label[for="addFiles"] {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 8px;
  background: linear-gradient(180deg, #f0f7ff, #e6f0ff);
  border: 1px solid lighten($primary, 36%);
  color: $primary;
  cursor: pointer;
  font-weight: 700;
}

/* thumbs preview container */
.thumbs {
  margin-top: 12px;

  h4 { margin: 8px 0; font-size: 1rem; font-weight: 600; }

  .thumb-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    align-items: flex-start;
  }

  .thumb {
    width: 88px;
    border-radius: 8px;
    background: #fff;
    border: 1px solid $border;
    padding: 8px;
    box-shadow: $shadow-sm;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    position: relative;

    img {
      width: 72px;
      height: 72px;
      object-fit: cover;
      border-radius: 6px;
      display: block;
    }

    small {
      display: block;
      text-align: center;
      font-size: 0.72rem;
      color: $muted;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .btn-close {
      position: absolute;
      top: 6px;
      right: 6px;
      width: 26px;
      height: 26px;
      font-size: 14px;
      line-height: 1;
    }
  }
}

/* preview "selectedFiles" thumbnails (same style) */
.selected-preview {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}
.preview-item {
  position: relative;
  width: 96px;
  text-align: center;
  img { width: 88px; height: 88px; object-fit: cover; border-radius: 8px; box-shadow: $shadow-sm; display:block; }
  small { color: $muted; font-size: 0.75rem; display:block; margin-top:6px; }
  .btn-close { position:absolute; top:6px; right:6px; }
}

/* ---------------------- VARIANTS TABLE (IMPROVED RESPONSIVE INPUTS & ALIGNMENT) ----------------------
   PLACE: merge/replace the existing table-related styles for variants in
   src/app/admin/product-upload.component.scss
*/

table.variants-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 8px;
  font-size: 0.95rem;
  table-layout: auto; /* allow columns to size naturally */

  thead {
    th {
      text-align: left;
      padding: 12px 10px;
      font-size: 0.85rem;
      font-weight: 700;
      color: $muted;
      border-bottom: 1px dashed rgba(0,0,0,0.06);
      white-space: nowrap;
    }
  }

  tbody {
    tr {
      td {
      /*  padding: 12px 10px;*/
        vertical-align: middle;
        /* Important: allow inputs inside to shrink properly on small screens */
        min-width: 0;
      }

      /* ensure inputs (variant-input) take full width of their cell */
      input.variant-input, input[type="number"].variant-input {
        width: 100%;
        box-sizing: border-box;
        min-width: 0; /* very important for flex/overflow contexts */
      }

      /* Action column (duplicate/remove) should keep a predictable width and not force the rest */
      td.actions-cell {
        width: 150px;            /* fixed-ish width for action buttons */
        white-space: nowrap;
        vertical-align: middle;
      }

      /* Buttons inside actions should stack on mobile */
      .variant-actions {
        display: flex;
        gap: 8px;
        align-items: center;
        justify-content: flex-end;
      }
    }
  }
}

/* TINY input polish (keeps style consistent) */
.variant-input {
  width: 100%;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid $border;
  background: linear-gradient(180deg, #ffffff, #fbfdff);
  font-size: 0.95rem;
  color: $text;
  box-sizing: border-box;
  transition: transform .08s ease, box-shadow .12s ease, border-color .12s ease;
}

/* Mobile behaviour: make table rows wrap and buttons stacked for small screens */

@media (max-width: 680px) {
   table.variants-table {
    width: 100%;

    thead {
      display: none; /* hide header on mobile */
    }

    tbody {
      tr {
        display: block;
        padding: 10px;
        border-bottom: 1px solid rgba(0,0,0,0.06);
        background: #fff;
        border-radius: 10px;
        margin-bottom: 10px;

        td {
          display: flex;               /* âœ… label left, input right */
          align-items: center;
          justify-content: space-between;
          padding: 8px 0;
          min-width: 0;
          gap: 10px;

          /* make sure input doesn't overflow */
          .variant-input {
            flex: 1;                   /* let input take available space */
            max-width: 60%;            /* adjust if you want wider inputs */
          }
        }

        /* label text before each input */
        td::before {
          content: attr(data-label);
          font-weight: 600;
          font-size: 0.9rem;
          color: $muted;
          width: 40%;                  /* label width on the left */
          text-align: left;
          flex-shrink: 0;
        }

        /* Actions cell layout */
        td.actions-cell {
          display: block;
          margin-top: 8px;

          .variant-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: flex-start;
          }
        }
      }
    }
  }

  /* input style consistent for mobile */
  .variant-input {
    padding: 0px;
    border-radius: 12px;
    font-size: 1rem;
  }
}

/* Desktop tweak: make action buttons inline and compact */
@media (min-width: 820px) {
  .variant-actions {
    flex-direction: row;
  }
}

/* ---------------------- NG-SELECT / MULTI SELECT TWEAKS ---------------------- */
.ng-select.ng-select {
  width: 100%;
  .ng-select-container {
    border: 1px solid $border;
    border-radius: 8px;
    padding: 6px 8px;
    min-height: 44px;
  }
  .ng-value {
    background: $primary;
    color: #fff;
    border-radius: 999px;
    padding: 4px 8px;
    margin-right: 6px;
    font-weight: 600;
  }
}

/* ---------------------- UTILITIES ---------------------- */
.muted { color: $muted; }
.loading, .no-products { text-align:center; color: $muted; padding: 16px 0; }

/* disabled state */
[disabled], button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* compact card variation */
.card.compact { padding: 10px; }

/* ---------------------- RESPONSIVE: DESKTOP ---------------------- */
@media (min-width: 820px) {
  .admin-container { padding: 18px; }

  .form-grid { grid-template-columns: repeat(2, 1fr); gap: 14px; }
  .form-grid .row-actions { grid-column: 1 / -1; }

  .thumb { width: 100px; img { width: 88px; height: 88px; } }
  .preview-item { width: 110px; img { width: 100px; height: 100px; } }

  /* on desktop, slightly smaller variant radius to match table */
  .variant-input { border-radius: 8px; padding: 8px 10px; font-size: 0.95rem; }
}

/* wide screens */
@media (min-width: 1200px) {
  .admin-container { max-width: 1200px; padding: 22px; }
  .form-grid { gap: 18px; }
}
